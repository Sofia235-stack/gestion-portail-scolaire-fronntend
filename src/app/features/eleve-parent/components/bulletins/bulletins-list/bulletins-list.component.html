<div class="bulletins-container">
  <h1 class="page-title">Mes bulletins</h1>

  <div *ngIf="loading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
  </div>

  <div *ngIf="!loading && bulletins.length === 0" class="empty-state">
    <mat-icon>description</mat-icon>
    <p>Aucun bulletin disponible pour le moment.</p>
  </div>

  <div *ngIf="!loading && bulletins.length > 0" class="bulletins-content">
    <mat-card>
      <mat-card-content>
        <table mat-table [dataSource]="bulletins">
          <!-- Trimestre Column -->
          <ng-container matColumnDef="trimestre">
            <th mat-header-cell *matHeaderCellDef> Trimestre </th>
            <td mat-cell *matCellDef="let bulletin"> Trimestre {{ bulletin.trimestre }} </td>
          </ng-container>

          <!-- Année scolaire Column -->
          <ng-container matColumnDef="anneeScolaire">
            <th mat-header-cell *matHeaderCellDef> Année scolaire </th>
            <td mat-cell *matCellDef="let bulletin"> {{ bulletin.anneeScolaire }} </td>
          </ng-container>

          <!-- Moyenne Column -->
          <ng-container matColumnDef="moyenne">
            <th mat-header-cell *matHeaderCellDef> Moyenne </th>
            <td mat-cell *matCellDef="let bulletin"> {{ bulletin.moyenne?.toFixed(2) || '0.00' }} / 20 </td>
          </ng-container>

          <!-- Date génération Column -->
          <ng-container matColumnDef="dateGeneration">
            <th mat-header-cell *matHeaderCellDef> Date de génération </th>
            <td mat-cell *matCellDef="let bulletin"> {{ bulletin.dateGeneration | date:'dd/MM/yyyy' }} </td>
          </ng-container>

          <!-- Actions Column -->
          <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef> Actions </th>
            <td mat-cell *matCellDef="let bulletin">
              <div class="action-buttons">
                <button mat-icon-button color="primary" [routerLink]="['/eleve-parent/bulletins', bulletin.id]" matTooltip="Voir le détail">
                  <mat-icon>visibility</mat-icon>
                </button>
                <button mat-icon-button color="accent" [routerLink]="['/eleve-parent/bulletins', bulletin.id, 'download']" matTooltip="Télécharger">
                  <mat-icon>download</mat-icon>
                </button>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </mat-card-content>
    </mat-card>
  </div>
</div>